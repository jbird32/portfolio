<head>
               <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
			   <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.20.2/math.js" type="text/javascript"></script>
</head>

<p>Largest eigenvalues by magnitude for A10, A20, A50, A100 :</p>
<div id="plot1" style="width:600px;height:100px;"></div>
<p>A100 eigenvalue convergence: <br>24 iterations before 3rd significant figure doesn't change with each iteration</p>
<div id="plot2" style="width:600px;height:250px;"></div>
<p>A100 eigenvalue error (log-scale):</p>
<div id="plot3" style="width:600px;height:250px;"></div>
<p>C estimate:   ~.990 to .994</p>
<div id="plot4" style="width:600px;height:250px;"> </div>

<b>Problem 2:</b>
<p>A100 With acceleration:</p>
<div id="plot5" style="width:600px;height:250px;"> </div>

<div id="plot6" style="width:600px;height:50px;"> </div>
<p>For the standard power method, 301 iterations are required to obtain 3 accurate digits. (3.99xxxxx)</br>Only 150 iterations
are required with the acceleration technique.</p>

<b>Problem 3:</b>
<div id="plot7" style="width:600px;height:250px;"> </div>
<p>As long as the initial vector chosen is not a multiple of the eigenvector
associated with lambda=1 (t(0, 0, 1) in this case),</br> mu will converge to 2 and in the same direction(from below) regardless of choice of x0.</p>


<script>

	
	//logify y-axis	
var layout = {
 
  yaxis: {
    type: 'log',
    autorange: true
  }
};


////////////////////////////////////////////////////////////////////////////	
function initA (N){

	var A = [];
	for (var i=0; i<N; i++)
		A.push([]);

	for(var i=0; i<N; i++){
		for(var j=0; j<N; j++){
		
		A[i][j] = 0;
		A[i][i] = 2;
		}
	}
	for(var i=0; i<N-1; i++){
		A[i][i+1] = -1;
		A[i+1][i] = -1;
		}
return A;
}
/////////////////////////////////////////////////////////////////////////////
function calcMu (A){
	
	var Mu=1;
	
	var x0 = [];
	
	var k = [];
	var MusubK = [];
	var MuTilde = [];
	
	for (var i=0; i<A.length; i++)
		x0.push(1);
	
	for (var i=0; i<1000; i++){
		
		var xn = math.multiply(A, x0);
		Mu = (math.norm(xn))/(math.norm(x0));
		
		k.push(i+1);
		MusubK.push(Mu);
			
		x0 = math.multiply(A, x0);
		x0 = math.multiply(1/(math.norm(x0)), x0);
		
		if (i>=2)
		MuTilde.push(MusubK[i-2] - ((MusubK[i-1]-MusubK[i-2])*(MusubK[i-1]-MusubK[i-2]))/(MusubK[i]-2*MusubK[i-1]+MusubK[i-2]));
	
	}
	document.getElementById('plot1').innerHTML += '<Br>Eigenvalue of A'+ A.length +': ' + Mu;
	
///////////////////////////////////////////////////////////////////A100 case
	
	if(A.length==100){
	Plotly.plot( plot2, [{
	x: k,
	y: MusubK }], {
	margin: { t: 0 } } );
	
	var error=[];
	var C = [];
	for(var i=0; i<1000; i++){
		error.push(Math.abs(MusubK[i] - Mu));
		if(error.length>1 && error.length<1000)
		C.push(error[i]/error[i-1]);
	}
	//////error plot
	Plotly.plot( plot3, [{
	x: k,
	y: error }], layout, {
	margin: { t: 0 } } );
	
	/////c plot
	Plotly.plot( plot4, [{
	x: k,
	y: C }], {
	margin: { t: 0 } } );

	
	Plotly.plot( plot5, [{
	x: k,
	y: MuTilde }], {
	margin: { t: 0 } } );
	
	document.getElementById('plot6').innerHTML += '<Br>Better estimate for eigenvalue of A100: ' + MuTilde[MuTilde.length-1];
	
	}
	
	
	return Mu;
	}
	
////////////////////////////////////////////////////////////////////////////

	console.log(calcMu(initA(10)));
	console.log(calcMu(initA(20)));
	console.log(calcMu(initA(50)));
	console.log(calcMu(initA(100)));
	///////////////////////////////////////////////////////////////////// number 3 testing
	var Mu=1;
	var A = [[2,0,0],[0,2,0],[0,0,1]];
	
	//var x0 = [-10, -10, -10];
	//var x0 = [99, -34, 1.34343];
	//var x0 = [9, 1993, 13];
	var x0 = [.0000045, .0002984, .02389676];
	//var x0 = [0, 0, 1];
	
	var k = [];
	var MusubK = [];
	var MuTilde = [];
	
	
	for (var i=0; i<50; i++){
		
		var xn = math.multiply(A, x0);
		Mu = math.norm(xn)/math.norm(x0);
		
		k.push(i+1);
		MusubK.push(Mu);
			
		x0 = math.multiply(A, x0);
		x0 = math.multiply(1/(math.norm(x0)), x0);
		
		}
	
	Plotly.plot( plot7, [{
	x: k,
	y: MusubK }], {
	margin: { t: 0 } } );
	console.log(MusubK);
	
	
</script>